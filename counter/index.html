const items = [
  {
    name: "おつかれ",
    points: 5,
    categories: ["挨拶", "定番"],
    isCustom: true,
    count: 0
  },
  {
    name: "すごい",
    points: 10,
    categories: ["えらい"],
    isCustom: false,
    count: 0
  },
  {
    name: "草",
    points: 3,
    categories: ["ネタ", "笑"],
    isCustom: true,
    count: 0
  }
];

let activeTab = "全て";

const grid = document.getElementById("grid");
const searchInput = document.getElementById("search");

// 描画
function render() {
  grid.innerHTML = "";
  const keyword = searchInput.value.toLowerCase();

  items
    .filter(item => {
      // 検索
      if (!item.name.toLowerCase().includes(keyword)) return false;

      // タブ判定
      if (activeTab === "全て") return true;
      if (activeTab === "カスタム") return item.isCustom;
      return item.categories.includes(activeTab);
    })
    .forEach(item => {
      const card = document.createElement("div");
      card.className = "card";

      let counterHTML = "";
      if (activeTab === "カスタム") {
        counterHTML = `
          <div class="counter">
            <button class="minus">-</button>
            <span>${item.count}</span>
            <button class="plus">+</button>
          </div>
        `;
      }

      card.innerHTML = `
        <div class="thumb"></div>
        <div class="name">${item.name}</div>
        <div class="point">${item.points} pt</div>
        ${counterHTML}
      `;

      if (activeTab === "カスタム") {
        card.querySelector(".plus").onclick = () => {
          item.count++;
          render();
        };
        card.querySelector(".minus").onclick = () => {
          if (item.count > 0) item.count--;
          render();
        };
      }

      grid.appendChild(card);
    });
}

// タブ切替
document.querySelectorAll("#tabs button").forEach(btn => {
  btn.addEventListener("click", () => {
    document.querySelector("#tabs .active").classList.remove("active");
    btn.classList.add("active");
    activeTab = btn.dataset.tab;
    render();
  });
});

// 検索
searchInput.addEventListener("input", render);

render();
